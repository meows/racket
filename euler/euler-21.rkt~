#lang racket

(require math/number-theory)
(require threading)
(require (rename-in racket/base [define fn]))
(require (rename-in racket/base [define def]))
(require srfi/26)

;; ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;; Project Euler
;; Problem 21

;; Find the sum of all amicable numbers under 10,000.

(fn sum (curry apply +))

(fn (amicable? n)
    (= n (- (sum (divisors n)) n)))

(for/sum ([n (in-naturals)] 
         #:break (< 10000 n)
         #:when (amicable? n)) n)
